= render partial: "header"
.breads
  - breadcrumb :item_show, @item
  = breadcrumbs separator: "#{content_tag(:i, '', class: 'fa fa-angle-right')}"
.default-container
  %section.item-container
    %h1 #{@item.name}
    .item-container__main-content
    .item-container__image
      = image_tag "#{@item_images[0]&.image}", alt: "", id: "main-box"
      -if @item.order_status_id == 2
        .sold-out-box
          .sold-out-text SOLD
      %ul.image-slide
        - @item_images.each do|item|
          %li
            =image_tag "#{item.image}",alt:"", class: "slide-box"

    %table.item-container__detail
      %tbody
        %tr
          %th 出品者
          %td
            = link_to "#{@item.user.nickname}"
        %tr
          %th カテゴリー
          %td
            = link_to "#{@item.first_category.first_category}"
            %br
            = link_to "\> #{@item.second_category.second_category}"
            %br
            = link_to "\> #{@item.third_category.third_category}"
        %tr
          %th ブランド
          %td #{@item.brand&.brand}
        %tr
          %th 商品のサイズ
          %td #{@item.size&.size}
        %tr
          %th 商品の状態
          %td #{@item.condition.condition}
        %tr
          %th 配送料の負担
          %td #{@item.delivery_charge.charge}
        %tr
          %th 配送の方法
          %td #{@item.delivery_way.way}
        %tr
          %th 配送元地域
          %td
            = link_to "#{@item.prefecture.prefecture}"
        %tr
          %th 発送日の目安
          %td #{@item.delivery_date.date}
    .item-container__price
      %span.item-price
        = number_to_currency(@item.price, format:"%u%n", unit: "￥", strip_insignificant_zeros: true)
      %span.item-taxIn
        (税込)
      %span.item-tax-include
        \送料込み
      -if user_signed_in?
        -if @item.user_id != current_user.id
          -if @item.order_status_id == 1
            = form_tag(action: :pay, method: :post) do
              %script.payjp-button{"data-key" => "pk_test_00ff76d8e072d9b17859bd34", src: "https://checkout.pay.jp", :type => "text/javascript", "data-text" => "商品を購入する", "data-submit-text" => "支払い完了", "data-payjp" => "016e8973300880b74ce3a321e59faa6ed94aa751"}
              = hidden_field_tag :price, @item.price
              = hidden_field_tag :user_id, @user.id
              -# = hidden_field_tag :customer_id, @user.customer_id
          -elsif @item.order_status_id == 2
            .order-status この商品は売却済です
        -else
          .no-text
      -else
        .order-status ログインしていないため購入できません
    .item-container__discription
      %p
      \#{@item.description}

  .comment
    .comment__box
      %p 相手のことを考え丁寧なコメントを心がけましょう。不快な言葉遣いなどは利用制限や退会処分となることがあります。
      .form
      .send コメントする
  / 変数が定義でき次第に下記のようにフォームを作成していく
  /     = form_for @comments do |f|
  /       =f.text_field :comment, class: 'form-content'
  /       =f.submit 'コメントする', class: 'form-submit'
  .sns-media
    %i.fab.fa-facebook-square
    %i.fab.fa-twitter-square
    %i.fab.fa-line
    %i.fab.fa-pinterest-square
  .other-item-box
    %h2
      = link_to "#{@item.user.nickname}さんのその他の商品", user_item_show_path(@item)
    .other-item-contents
      -@item.user.items.first(6).each do |item|
        .other-item-contents__box
          = link_to "#{item.id}" do
            .photo
              = image_tag "#{item.item_images[0].image}"
            .text
              %h3 #{item.name}
              .price-box
                .price= number_to_currency(item.price, unit: "￥", strip_insignificant_zeros: true)
                = fa_icon "heart"
                %span
                  #{item.likes.count}
                %p （税込）

  .other-item-box
    %h2
      = link_to "#{@item.third_category.third_category}(#{@item.first_category.first_category})のその他の商品", thirdcategory_path(@item)
    .other-item-contents
      - Item.where(third_category_id: @item.third_category.id).first(6).each do |item|
        .other-item-contents__box
          = link_to "#{item.id}" do
            .photo
              = image_tag "#{item.item_images[0].image}"
            .text
              %h3 #{item.name}
              .price-box
                .price= number_to_currency(item.price, unit: "￥", strip_insignificant_zeros: true)
                = fa_icon "heart"
                %span
                  #{item.likes.count}
                %p （税込）
      
= render partial: "footer"
